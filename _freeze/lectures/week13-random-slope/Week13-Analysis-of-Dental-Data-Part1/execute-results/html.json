{
  "hash": "1fd7dbc2859db3fd288b234b96abdcd1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysis of Dental Growth Data Using Mixed-Effects Models\"\nformat: html\n---\n\n\n\n\n# Introduction\n\nThis analysis examines the dental growth data to investigate the development of children's teeth over time. Specifically, we analyze the distance from the center of the pituitary gland to the pteryomaxillary fissure (referred to as \"distance\") measured at ages 8, 10, 12, and 14 years. The data includes observations from both boys and girls, allowing us to compare growth patterns between genders.\n\n**Objectives:**\n\n- Explore growth patterns of boys and girls over time.\n- Model the distance as a function of age and gender using mixed-effects models.\n- Compare different covariance structures and select the best-fitting model.\n- Interpret the results and understand implications for dental growth.\n\n# Data Preparation\n\n## Loading Libraries\n\nWe use the `tidyverse` suite for data manipulation, `lme4` and `nlme` for mixed-effects modeling, and `ggplot2` for visualization.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\n# For various statistical functions\npacman::p_load(tidyverse, nlme, lme4, ggplot2, heplots, car, see, ggpubr, sandwich, clubSandwich, clubSandwich, lmerTest, GGally, here)\n# Set the theme for ggplot2\nggplot2::theme_set(see::theme_modern())\n```\n:::\n\n\n\n\n- **`tidyverse`:** For data manipulation and visualization.\n- **`nlme`:** For fitting linear and nonlinear mixed-effects models.\n- **`lme4`:** For fitting linear mixed-effects models.\n- **`ggplot2`:** For enhanced data visualization.\n- **`heplots`:** For testing covariance matrices.\n- **`car`:** For various statistical functions.\n- **`see`:** For custom themes and color palettes.\n- **`ggpubr`:** For publication-ready plots.\n- **`sandwich`:** For robust standard errors.\n- **`clubSandwich`:** For cluster-robust variance-covariance matrices.\n\n## Loading and Exploring the Data\n\nThe dental data is loaded from the provided file. We begin by reading the data and examining its structure.\n\n\n\n\n::: {#tbl-load-data .cell tbl-cap='Dental Data: First Few Rows'}\n\n```{.r .cell-code}\n# Load the dental data\n\n# dental_data <- readr::read_table(\"https://raw.githubusercontent.com/quantPsych/test-web/refs/heads/main/data/dental.dat\",\n#     col_names = c(\"obs\", \"child\", \"age\", \"distance\", \"gender\")\n# )\n\n# dat_file <- here(\"data\", \"dental.dat\")\n# Load the dental data\ndental_data <- readr::read_table(\"dental.dat\",\n    col_names = c(\"obs\", \"child\", \"age\", \"distance\", \"gender\")\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n── Column specification ────────────────────────────────────────────────────────\ncols(\n  obs = col_double(),\n  child = col_double(),\n  age = col_double(),\n  distance = col_double(),\n  gender = col_double()\n)\n```\n\n\n:::\n\n```{.r .cell-code}\n# Examine the first few rows\nhead(dental_data)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| obs| child| age| distance| gender|\n|---:|-----:|---:|--------:|------:|\n|   1|     1|   8|     21.0|      0|\n|   2|     1|  10|     20.0|      0|\n|   3|     1|  12|     21.5|      0|\n|   4|     1|  14|     23.0|      0|\n|   5|     2|   8|     21.0|      0|\n|   6|     2|  10|     21.5|      0|\n\n</div>\n:::\n:::\n\n\n\n\n## Data Cleaning and Transformation\n\nWe convert the `gender` variable to a factor with labels for better readability and create separate datasets for boys and girls.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert gender to a factor with labels\ndental_data <- dental_data |> \n  mutate(\n    gender = factor(gender, levels = c(0, 1), labels = c(\"Girl\", \"Boy\")),\n    child = factor(child)\n  )\n\n# Create separate datasets for girls and boys\ndental_girls <- dental_data |>  filter(gender == \"Girl\")\ndental_boys <- dental_data |>  filter(gender == \"Boy\")\n```\n:::\n\n\n\n\n## Calculating Mean Distances\n\nWe calculate the mean distance for each age and gender group.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate mean distances by age and gender\nmean_distances <- dental_data |> \n  group_by(age, gender) |> \n  summarize(mean_distance = mean(distance))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'age'. You can override using the `.groups`\nargument.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Display the mean distances\nmean_distances\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| age|gender | mean_distance|\n|---:|:------|-------------:|\n|   8|Girl   |      21.18182|\n|   8|Boy    |      22.87500|\n|  10|Girl   |      22.22727|\n|  10|Boy    |      23.81250|\n|  12|Girl   |      23.09091|\n|  12|Boy    |      25.71875|\n|  14|Girl   |      24.09091|\n|  14|Boy    |      27.46875|\n\n</div>\n:::\n:::\n\n\n\n\n## Boxplot by age for boys and girls\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndental_data |>\n  ggplot(aes(x = factor(age), y= distance, fill= gender)) +\n    geom_boxplot() +\n    labs(\n        x = \"Age\",\n        y = \"Distance\")+\n    see::scale_color_see_d()\n```\n\n::: {.cell-output-display}\n![Boxplot of Distance by Age and Gender](Week13-Analysis-of-Dental-Data-Part1_files/figure-html/fig-boxplot-1.png){#fig-boxplot width=672}\n:::\n:::\n\n\n\n\n# Exploratory Data Analysis\n\n## Visualizing Growth Patterns\n\n### Interaction Plot\n\nWe create an interaction plot to visualize the growth patterns of boys and girls over time.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Interaction plot for age and gender\nggplot(dental_data, aes(x = age, y = distance, color = gender, group = child)) +\n  geom_line(alpha = 0.3) +\n  stat_summary(aes(group = gender), fun = mean, geom = \"line\", size = 1.5) +\n  labs(\n    title = \"Dental Growth Over Age by Gender\",\n    x = \"Age\",\n    y = \"Distance\",\n    color = \"Gender\"\n  ) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Dental Growth Over ](Week13-Analysis-of-Dental-Data-Part1_files/figure-html/fig-interaction-plot-1.png){#fig-interaction-plot width=672}\n:::\n:::\n\n\n\n\n*Figure 1: Interaction plot showing dental growth over age by gender.*\n\n### Scatterplot Matrices\n\nWe create scatterplot matrices to explore the relationships between distances at different ages for boys and girls.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert data from long to wide format\ndental_wide <- dental_data |> \n  select(child, gender, age, distance) |> \n  pivot_wider(names_from = age, values_from = distance, names_prefix = \"Age_\")\n\n# Separate datasets for girls and boys\ndental_wide_girls <- dental_wide |>  filter(gender == \"Girl\")\ndental_wide_boys <- dental_wide |>  filter(gender == \"Boy\")\n```\n:::\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\n# Scatterplot matrix for girls\nggpairs(dental_wide_girls |>  select(starts_with(\"Age_\")),\n        title = \"Scatterplot Matrix for Girls\")\n\n# Scatterplot matrix for boys\nggpairs(dental_wide_boys |>  select(starts_with(\"Age_\")),\n        title = \"Scatterplot Matrix for Boys\")\n```\n\n::: {.cell-output-display}\n![](Week13-Analysis-of-Dental-Data-Part1_files/figure-html/fig-scatterplot-matrix-1.png){#fig-scatterplot-matrix-1 width=672}\n:::\n\n::: {.cell-output-display}\n![](Week13-Analysis-of-Dental-Data-Part1_files/figure-html/fig-scatterplot-matrix-2.png){#fig-scatterplot-matrix-2 width=672}\n:::\n:::\n\n\n\n\n*Figure 2: Scatterplot matrices for girls and boys showing relationships between distances at different ages.*\n\n## Covariance and Correlation Matrices\n\nWe compute covariance and correlation matrices for distances at different ages for boys and girls.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Covariance and correlation for girls\ncov_girls <- cov(dental_wide_girls |> select(starts_with(\"Age_\")), use = \"complete.obs\")\ncorr_girls <- cor(dental_wide_girls |> select(starts_with(\"Age_\")), use = \"complete.obs\")\n\n# Covariance and correlation for boys\ncov_boys <- cov(dental_wide_boys |> select(starts_with(\"Age_\")), use = \"complete.obs\")\ncorr_boys <- cor(dental_wide_boys |> select(starts_with(\"Age_\")), use = \"complete.obs\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Display correlation\nround(corr_girls, 2)[lower.tri(corr_girls)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.83 0.86 0.84 0.90 0.88 0.95\n```\n\n\n:::\n\n```{.r .cell-code}\nround(corr_boys, 2)[lower.tri(corr_boys)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.44 0.56 0.32 0.39 0.63 0.59\n```\n\n\n:::\n:::\n\n\n\n\n**Interpretation:** The covariance and correlation matrices indicate how distances at different ages are related within each gender group.\n\n## Testing Equivalence of Covariance Matrices\n\nWe use the `boxM` test to check if the covariance matrices are equivalent across genders.\n\n\n\n\n::: {.cell tbl-cap='Box\\'s M Test for Covariance Matrices'}\n\n```{.r .cell-code}\n# Perform Box's M test\nboxm_result <- boxM(dental_wide |>  select(starts_with(\"Age_\")), dental_wide$gender)\n\n# Display the result\nboxm_result\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBox's M-test for Homogeneity of Covariance Matrices\n\ndata:  select(dental_wide, starts_with(\"Age_\"))\nChi-Sq (approx.) = 17.335, df = 10, p-value = 0.06727\n```\n\n\n:::\n:::\n\n\n\n\n**Interpretation:** A significant result (p-value < 0.05) suggests that the covariance matrices are different across genders.\n\n# Modeling\n\nWe aim to model the `distance` as a function of `age` and `gender`, accounting for the repeated measures within each child.\n\n## Model 1: Linear Mixed-Effects Model Using `lme4`\n\nWe use the `lme4` package to fit a linear mixed-effects model with random intercepts and slopes for each child.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the mixed-effects model with random intercept and slope for age\nmodel_lme4 <- lmer(distance ~ age * gender + (age | child), data = dental_data)\n\n# Display the model summary\nsummary(model_lme4, correlation = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: distance ~ age * gender + (age | child)\n   Data: dental_data\n\nREML criterion at convergence: 432.6\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.1694 -0.3862  0.0070  0.4454  3.8490 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr \n child    (Intercept) 5.77449  2.4030        \n          age         0.03245  0.1801   -0.67\n Residual             1.71663  1.3102        \nNumber of obs: 108, groups:  child, 27\n\nFixed effects:\n              Estimate Std. Error      df t value Pr(>|t|)    \n(Intercept)    17.3727     1.2281 25.0078  14.147 1.94e-13 ***\nage             0.4795     0.1037 25.0113   4.625 9.85e-05 ***\ngenderBoy      -1.0321     1.5953 25.0078  -0.647   0.5235    \nage:genderBoy   0.3048     0.1347 25.0113   2.263   0.0326 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n### Interpretation\n\n- **Fixed Effects:** Estimates of the average effect of age, gender, and their interaction on distance.\n- **Random Effects:** Allows each child to have their own intercept and slope, capturing individual growth trajectories.\n\n## Model 2: Generalized Least Squares Using `nlme`\n\nWe explore different covariance structures using the `nlme` package's `gls` function.\n\n### Compound Symmetry with Different Variances by Gender\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit GLS model with compound symmetry and different variances by gender\nmodel_cs2 <- gls(distance ~ age * gender,\n    data = dental_data,\n    correlation = corCompSymm(form = ~ 1 | child),\n    weights = varIdent(form = ~ 1 | gender),\n    method = \"ML\"\n)\n\n# Display the model summary\nsummary(model_cs2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeneralized least squares fit by maximum likelihood\n  Model: distance ~ age * gender \n  Data: dental_data \n       AIC     BIC    logLik\n  430.6521 449.427 -208.3261\n\nCorrelation Structure: Compound symmetry\n Formula: ~1 | child \n Parameter estimate(s):\n      Rho \n0.7228109 \nVariance function:\n Structure: Different standard deviations per stratum\n Formula: ~1 | gender \n Parameter estimates:\n   Girl     Boy \n1.00000 1.71672 \n\nCoefficients:\n                  Value Std.Error   t-value p-value\n(Intercept)   17.372727 0.8175862 21.248802  0.0000\nage            0.479545 0.0612544  7.828755  0.0000\ngenderBoy     -1.032102 1.4222595 -0.725678  0.4697\nage:genderBoy  0.304830 0.1065571  2.860716  0.0051\n\n Correlation: \n              (Intr) age    gndrBy\nage           -0.824              \ngenderBoy     -0.575  0.474       \nage:genderBoy  0.474 -0.575 -0.824\n\nStandardized residuals:\n        Min          Q1         Med          Q3         Max \n-2.78081373 -0.63039864 -0.08111374  0.52140257  2.87744432 \n\nResidual standard error: 1.693422 \nDegrees of freedom: 108 total; 104 residual\n```\n\n\n:::\n:::\n\n\n\n\n### Autoregressive Structure (AR(1))\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit GLS model with AR(1) correlation structure\nmodel_ar1 <- gls(distance ~ age * gender,\n    data = dental_data,\n    correlation = corAR1(form = ~ 1 | child),\n    method = \"ML\"\n)\n\n# Display the model summary\nsummary(model_ar1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeneralized least squares fit by maximum likelihood\n  Model: distance ~ age * gender \n  Data: dental_data \n      AIC      BIC    logLik\n  452.681 468.7738 -220.3405\n\nCorrelation Structure: AR(1)\n Formula: ~1 | child \n Parameter estimate(s):\n      Phi \n0.6071166 \n\nCoefficients:\n                  Value Std.Error   t-value p-value\n(Intercept)   17.321720 1.6345089 10.597507  0.0000\nage            0.483732 0.1409898  3.430973  0.0009\ngenderBoy     -0.729724 2.1232893 -0.343676  0.7318\nage:genderBoy  0.285840 0.1831511  1.560676  0.1216\n\n Correlation: \n              (Intr) age    gndrBy\nage           -0.949              \ngenderBoy     -0.770  0.730       \nage:genderBoy  0.730 -0.770 -0.949\n\nStandardized residuals:\n       Min         Q1        Med         Q3        Max \n-2.5993844 -0.6176776 -0.0866274  0.5525954  2.3391875 \n\nResidual standard error: 2.211512 \nDegrees of freedom: 108 total; 104 residual\n```\n\n\n:::\n:::\n\n\n\n\n### Autoregressive Structure (AR(1)) with Different Variances by Gender\n\n\n\n\n::: {.cell tbl-cap='GLS Model with AR(1) and Different Variances Gender'}\n\n```{.r .cell-code}\n# Fit GLS model with AR(1) correlation structure and different\n# variances\nmodel_ar1_var <- gls(distance ~ age* gender ,\n    data = dental_data,\n    correlation = corAR1(form = ~ 1 | child),\n    weights = varIdent(form = ~ 1 | gender ),\n    method = \"ML\"\n)\n\n# Display the model summary\nsummary(model_ar1_var)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeneralized least squares fit by maximum likelihood\n  Model: distance ~ age * gender \n  Data: dental_data \n       AIC      BIC    logLik\n  443.0267 461.8016 -214.5134\n\nCorrelation Structure: AR(1)\n Formula: ~1 | child \n Parameter estimate(s):\n      Phi \n0.7324446 \nVariance function:\n Structure: Different standard deviations per stratum\n Formula: ~1 | gender \n Parameter estimates:\n    Girl      Boy \n1.000000 1.754618 \n\nCoefficients:\n                  Value Std.Error   t-value p-value\n(Intercept)   17.313902 1.1306479 15.313258  0.0000\nage            0.484296 0.0951268  5.091058  0.0000\ngenderBoy     -0.671131 1.9960327 -0.336233  0.7374\nage:genderBoy  0.283281 0.1679358  1.686843  0.0946\n\n Correlation: \n              (Intr) age    gndrBy\nage           -0.925              \ngenderBoy     -0.566  0.524       \nage:genderBoy  0.524 -0.566 -0.925\n\nStandardized residuals:\n       Min         Q1        Med         Q3        Max \n-2.7804651 -0.6410424 -0.1037228  0.5233202  2.8909363 \n\nResidual standard error: 1.686147 \nDegrees of freedom: 108 total; 104 residual\n```\n\n\n:::\n:::\n\n\n\n\n## Model Comparison\n\nWe compare models using Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compare models\nanova(model_cs2, model_ar1, model_ar1_var)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|              |call                                                                                                                                                                        | Model| df|      AIC|      BIC|    logLik|Test   | L.Ratio|   p-value|\n|:-------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----:|--:|--------:|--------:|---------:|:------|-------:|---------:|\n|model_cs2     |gls(model = distance ~ age * gender, data = dental_data, correlation = corCompSymm(form = ~1 &#124;     child), weights = varIdent(form = ~1 &#124; gender), method = \"ML\") |     1|  7| 430.6521| 449.4270| -208.3261|       |      NA|        NA|\n|model_ar1     |gls(model = distance ~ age * gender, data = dental_data, correlation = corAR1(form = ~1 &#124;     child), method = \"ML\")                                                   |     2|  6| 452.6810| 468.7738| -220.3405|1 vs 2 | 24.0289| 0.0000009|\n|model_ar1_var |gls(model = distance ~ age * gender, data = dental_data, correlation = corAR1(form = ~1 &#124;     child), weights = varIdent(form = ~1 &#124; gender), method = \"ML\")      |     3|  7| 443.0267| 461.8016| -214.5134|2 vs 3 | 11.6543| 0.0006405|\n\n</div>\n:::\n:::\n\n\n\n\n**Interpretation:** The model with the lower AIC and BIC values is considered to have a better fit.\n\n## Robust Standard Errors\n\nWe calculate robust standard errors for the selected GLS model.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrobust_vcov_lmm <- clubSandwich::vcovCR(model_cs2, type = \"CR2\")\n# Cluster-robust variance-covariance matrix\nse_cs2_robust <- robust_vcov_lmm |>\n    diag() |>\n    sqrt()\nse_cs2_robust\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept)           age     genderBoy age:genderBoy \n   0.78985669    0.06876072    1.48408299    0.12591257 \n```\n\n\n:::\n:::\n\n\n\n\n- `vcovCR` function from the `clubSandwich` package is used to calculate robust standard errors.\n- `type = \"CR2\"` specifies the HC2 estimator for robust standard errors.\n\nFrom the package documentation:\n\n- `\"CR0\"` is the original form of the sandwich estimator (Liang & Zeger, 1986), which does not make any small-sample correction.\n- `\"CR2\"` is the \"bias-reduced linearization\" adjustment proposed by Bell and McCaffrey (2002) and further developed in Pustejovsky and Tipton (2017). The adjustment is chosen so that the variance-covariance estimator is exactly unbiased under a user-specified working model.\n\n## Hypothesis Testing\n\nWe perform hypothesis testing for the selected GLS model using robust standard errors.\n\n\n\n\n::: {#tbl-hypothesis-testing-robust .cell tbl-cap='Hypothesis Testing for the GLS Model with Robust Standard Errors'}\n\n```{.r .cell-code}\nclubSandwich::coef_test(model_cs2, vcov = robust_vcov_lmm, test = \"Satterthwaite\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|              |Coef          |       beta|        SE|      tstat|   df_Satt|    p_Satt|\n|:-------------|:-------------|----------:|---------:|----------:|---------:|---------:|\n|(Intercept)   |(Intercept)   | 17.3727273| 0.7898567| 21.9947839|  9.921757| 0.0000000|\n|age           |age           |  0.4795455| 0.0687607|  6.9741190|  9.921757| 0.0000399|\n|genderBoy     |genderBoy     | -1.0321023| 1.4840830| -0.6954478| 24.357177| 0.4933570|\n|age:genderBoy |age:genderBoy |  0.3048295| 0.1259126|  2.4209619| 24.357177| 0.0232849|\n\n</div>\n:::\n:::\n\n\n\n\n\n\n# Results\n\n## Model Summaries\n\n### Mixed-Effects Model (`lme4`)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fixed effects\nfixef(model_lme4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept)           age     genderBoy age:genderBoy \n   17.3727273     0.4795455    -1.0321023     0.3048295 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Random effects summary\nprint(VarCorr(model_lme4), comp = c(\"Variance\", \"Std.Dev.\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Groups   Name        Variance Std.Dev. Corr  \n child    (Intercept) 5.774487 2.40302        \n          age         0.032452 0.18014  -0.667\n Residual             1.716625 1.31020        \n```\n\n\n:::\n:::\n\n\n\n\n**Key Findings:**\n\n- The interaction between age and gender is significant, suggesting different growth rates between boys and girls.\n- The random effects indicate substantial variability between children in both baseline distance and growth rates.\n\n### GLS Model with Compound Symmetry (`nlme`)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fixed effects coefficients\ncoef(model_cs2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept)           age     genderBoy age:genderBoy \n   17.3727273     0.4795455    -1.0321023     0.3048295 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Standard errors (model-based)\nsummary(model_cs2)$tTable[, \"Std.Error\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept)           age     genderBoy age:genderBoy \n   0.81758620    0.06125437    1.42225948    0.10655709 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Robust standard errors\nse_cs2_robust\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept)           age     genderBoy age:genderBoy \n   0.78985669    0.06876072    1.48408299    0.12591257 \n```\n\n\n:::\n:::\n\n\n\n\n**Key Findings:**\n\n- The compound symmetry structure with different variances by gender fits the data well.\n- Robust standard errors provide a more reliable inference when model assumptions may be violated.\n\n## Visualizations\n\n### Predicted Growth Curves\n\nWe plot the predicted growth curves for boys and girls based on the mixed-effects model.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add predicted values to the data\ndental_data <- dental_data |> \n  mutate(pred_distance = predict(model_lme4))\n\n# Plot observed and predicted distances\nggplot(dental_data, aes(x = age, y = distance, color = gender)) +\n  geom_point(alpha = 0.5) +\n  geom_line(aes(y = pred_distance, group = child), linetype = \"dashed\") +\n  stat_summary(aes(y = pred_distance, group = gender), fun = mean, geom = \"line\", size = 1.5) +\n  facet_wrap(~ gender) +\n  labs(\n    title = \"Observed and Predicted Dental Growth\",\n    x = \"Age\",\n    y = \"Distance\",\n    color = \"Gender\"\n  )\n```\n\n::: {.cell-output-display}\n![Observed and Predicted Dental Growth](Week13-Analysis-of-Dental-Data-Part1_files/figure-html/fig-predicted-growth-curves-1.png){#fig-predicted-growth-curves width=672}\n:::\n:::\n\n\n\n\n*Figure 3: Observed and predicted dental growth curves for boys and girls.*\n\n### Residual Diagnostics\n\nWe examine the residuals to assess model assumptions.\n\n\n\n\n::: {.cell .column-body-outset}\n\n```{.r .cell-code}\n# Residual plots for the lme4 model\nperformance::check_model(model_lme4)\n```\n\n::: {.cell-output-display}\n![Diagnostics Plots for the lme4 Model](Week13-Analysis-of-Dental-Data-Part1_files/figure-html/fig-residual-plots-1.png){#fig-residual-plots width=672}\n:::\n:::\n\n\n\n\n**Interpretation:** The residual plots help assess the homoscedasticity and normality of residuals. Deviations from the line in the QQ-plot may suggest non-normality.\n\n# Conclusion\n\nIn this analysis, we investigated dental growth patterns in children using mixed-effects models. Our findings indicate that:\n\n- **Growth Patterns:** Both boys and girls show an increase in the distance measure with age, but boys tend to have a steeper growth trajectory.\n- **Model Selection:** The mixed-effects model with random intercepts and slopes provided a good fit, capturing individual variability in growth.\n- **Covariance Structures:** The GLS model with compound symmetry and different variances by gender was supported by the data, indicating that variability differs between genders.\n\n**Implications:** Understanding these growth patterns can aid in pediatric dental assessments, orthodontic planning, and early interventions when necessary.\n\n**Future Work:**\n\n- **Additional Covariates:** Incorporate factors such as socioeconomic status, nutrition, or health conditions to further explain variability in growth.\n- **Longitudinal Follow-Up:** Extend the study to include more time points or follow-up into adulthood to model long-term growth patterns.\n- **Advanced Modeling:** Explore nonlinear mixed-effects models or growth curve models if growth patterns are not strictly linear.\n\n# References\n\n- Pinheiro, J. C., & Bates, D. M. (2000). *Mixed-Effects Models in S and S-PLUS*. Springer.\n- Bates, D., Mächler, M., Bolker, B., & Walker, S. (2015). Fitting Linear Mixed-Effects Models Using *lme4*. *Journal of Statistical Software*, 67(1), 1–48.\n- Wickham, H. (2016). *ggplot2: Elegant Graphics for Data Analysis*. Springer-Verlag New York.\n- Fox, J., & Weisberg, S. (2019). *An R Companion to Applied Regression*. Sage Publications.\n",
    "supporting": [
      "Week13-Analysis-of-Dental-Data-Part1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}